# BERT-T6
By fine-tuning the ProtBert protein language model on T6SS effector (T6SE) classification tasks, BERT-T6 can learn directly from sequence data without relying on handcrafted features, achieving state-of-the-art prediction performance.
![image](https://github.com/mxw1992/BERT-T6/blob/main/image/%E4%B8%BB%E5%9B%BE%E9%A2%9C%E8%89%B2.jpg)
A BERT-based transfer learning approach for T6SE prediction
## Set up
## Usage
### Preprocessing
For trainning BERT-T6 model, the fasta file should be like this:
```
>52840344|0|
MTIWIDADACPKMIKDILFRAAIRTNTNLILVANSYLTYPNSPFIRSVLVEKGYDRADHYITSHMKAKDLVITADIPLAAEVIVKQGLAMSPRGELFTANNIKQRLTLRDINEQLRSAGERTGGPSALSAKEKTNFANALDRWLAKSK
>52841132|0|
MNPILNLIISFIALLWAANHLVAGSSGLAIRFQLSPLMIGLTIVALGTSAPELFISIISSLKDKNDLAIGNAIGSNIANIGLILGIIILIKPTSFHFNKLKKVYPILIIVMLFAYSLILDGYLGTIDGCLFLIGCIAVLCYFIYLASHSPKRDLSVNEFRPAILSYRSTPSNLLSIAIGLLILPICSKYLVYNASEIAKWAGISEFTIGLTIIAIGSSLPELTTALVAAIKGEDSIAIGTIIGSNIYNLLLILALPGLLNPTKISSVVLWRDMPVMLSITLLLLFLNYYYQKKTSSWPGGILLLVYFCYMASLIINAHS
>EFF01487|1|
MKNFEVIRKDFLQSIEIYINHPYKSHFLSIHHRHRDTGIRRAALLKDYILHCPNLTIMNQLIKHYLERSQELEEVLLNLKLQYKKTITKAEIKVDASLLRGGNKHPSSLWTYVNNVFQQTKNQAPIENNLSIINNPIFDVFLPVQNISKIGNSTASAHVVTRYKDKKNEKVNYFVKSLNNNEVENAIAEVIYAQIWNYFIGNRASKSLLLLSEHENKIIGIASKGISDFQEYKSLSGDQKDYPGLIQILFYVCVLIENDFHICNFGTGLFNGKRCYSKIDHDYIVSFWDALKYGKFMTEVSHNFKELFKKKSMSSLFLLLESMRFSPVKANSRILELGHKIRLGRPSTVTSHMMMSQFRNKAITRSNQKELEYTINDFILKTRPAEISRFFSDLEGVLMTKIAPLIQYNYKYLGKSNELLFFFKLRFSHLCNLLN
......
```
```|1|```represents T6SE, and ```|0|```represents non-T6SE. Then the input files can be generated by running ```fasta_to_csv.py```.

### Train model
You can train the BERT-T6 model by running ```train.py```, then evaluate on test set by running ```test.py```.
```
cd ./train
python train.py --train_dir ./train_set.csv --valid_dir ./valid_set.csv --result_dir ./result-training.csv --checkpoint_path ./best_model.pt --batch-size 6 --lr 1e-5 --weight_decay 5e-3 --epochs 100 --patience 5
```
Parameters:
- ```--train_dir``` path to the input training set file.
- ```--valid_dir``` path to the input validation set file.
- ```--result_dir``` directory that stores the evaluation results on training set and validation set per epoch.
- ```--checkpoint_path``` directory that stores the model weights file.
- ```--batch-size``` batch size for training.
- ```--lr``` learning rate for training.
- ```--weight_decay``` weight_decay rate of the model.
- ```--epochs``` number of training epoch.
- ```--patience``` patience for early stopping used in training.
```
python test.py --checkpoint_path ./best_model.pt --test_dir ./test_set.csv --result_dir ./result-test.csv
```
Parameters:
- ```--checkpoint_path``` directory that stores the model weights file.
- ```--test_dir``` path to the input test set file.
- ```--result_dir``` directory that stores the evaluation results on test set.
  
### Prediction
You can predict your interested ptotein,  here we give an example of T6SE prediction:
```
cd ./PredictT6SE
python predictT6SE.py --test_dir ./hypo.fasta --result_dir ./hypo.csv --checkpoint_path ./best_model_train_valid_set.pt
```
Parameters:
- ```--test_dir``` path to the input protein FASTA file.
- ```--result_dir``` directory that stores prediction outputs (CSV table).
- ```--checkpoint_path``` path to the model weights (download from [here](https://drive.google.com/drive/folders/1dPDHxY7ga4JVDC6R4OdPueeYdQjR_Peg)).

## Contact
Please contact Xianwei Mo at 13580342797@163.com for questions.
